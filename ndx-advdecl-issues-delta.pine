// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © henry_oliver

//@version=6
indicator(title = "NASDAQ 100 Advance-Decline Issues Delta", shorttitle = "NDX A/D Δ", overlay = false)

// === CONSTANTS ===
// Nord Theme Color
const color NORD1  = #3B4252
const color NORD8  = #88C0D0
const color NORD9  = #81A1C1

// === DATA FETCHING ===
// Fetch NASDAQ 100 advancing and declining issues
float advIssues = request.security(symbol = "USI:ADVN.NQ", timeframe = timeframe.period, expression = close, lookahead = barmerge.lookahead_off)
float declIssues = request.security(symbol = "USI:DECL.NQ", timeframe = timeframe.period, expression = close, lookahead = barmerge.lookahead_off)

// Calculate advance-decline delta (difference between advancing and declining issues)
float advDeclDelta = advIssues - declIssues

// === VISUALIZATION ===
// Determine bar color based on delta direction
color barColor = advDeclDelta >= 0 ? NORD8 : NORD9

// Plot advance-decline delta as candlestick bars without wicks or borders
plotcandle(open = 0, high = math.max(0, advDeclDelta), low = math.min(0, advDeclDelta), close = advDeclDelta, title = "Advance-Decline Delta", color = barColor, wickcolor = na, bordercolor = na, editable = true)

// Plot zero line
hline(price = 0, title = "Zero Line", color = NORD1, linestyle = hline.style_solid, linewidth = 2, editable = true)
