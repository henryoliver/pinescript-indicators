// This Pine Script® code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © henry_oliver

//@version=6
indicator(title = "NASDAQ 100 Up-Down Volume Delta", shorttitle = "NDX Vol Δ", overlay = false)

// === CONSTANTS ===
// Nord Theme Color
const color NORD1  = #3B4252
const color NORD8  = #88C0D0
const color NORD9  = #81A1C1

// === DATA FETCHING ===
// Fetch NASDAQ 100 up volume OHLC
[upVolOpen, upVolHigh, upVolLow, upVolClose] = request.security(symbol = "USI:UPVOL.NQ", timeframe = timeframe.period, expression = [open, high, low, close], lookahead = barmerge.lookahead_off)

// Fetch NASDAQ 100 down volume OHLC
[downVolOpen, downVolHigh, downVolLow, downVolClose] = request.security(symbol = "USI:DNVOL.NQ", timeframe = timeframe.period, expression = [open, high, low, close], lookahead = barmerge.lookahead_off)

// Calculate volume delta for each OHLC component
float deltaOpen = upVolOpen - downVolOpen
float deltaHigh = upVolHigh - downVolHigh
float deltaLow = upVolLow - downVolLow
float deltaClose = upVolClose - downVolClose

// === VISUALIZATION ===
// Determine candle color based on open vs close
color candleColor = deltaClose >= deltaOpen ? NORD8 : NORD9

// Plot volume delta as candlesticks
plotcandle(open = deltaOpen, high = deltaHigh, low = deltaLow, close = deltaClose, title = "Volume Delta", color = candleColor, wickcolor = candleColor, bordercolor = candleColor, editable = true)

// Plot zero line
hline(price = 0, title = "Zero Line", color = NORD1, linestyle = hline.style_solid, linewidth = 3, editable = true)
